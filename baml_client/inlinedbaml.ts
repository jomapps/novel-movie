/*************************************************************************************************

Welcome to Baml! To use this generated code, please run one of the following:

$ npm install @boundaryml/baml
$ yarn add @boundaryml/baml
$ pnpm add @boundaryml/baml

*************************************************************************************************/

// This file was generated by BAML: please do not edit it. Instead, edit the
// BAML files and re-generate this code using: baml-cli generate
// You can install baml-cli with:
//  $ npm install @boundaryml/baml
//
/* eslint-disable */
// tslint:disable
// @ts-nocheck
// biome-ignore format: autogenerated code

const fileMap = {
  
  "character_development.baml": "// Character Development BAML Functions\n// Generates detailed character profiles based on story structure and content\n\n// Response types for character development\nclass CharacterDevelopmentResponse {\n  characters Character[]\n  qualityMetrics CharacterQualityMetrics\n  generationNotes string\n}\n\nclass Character {\n  name string\n  role string // protagonist, antagonist, supporting, minor\n  archetype string?\n  characterDevelopment CharacterDevelopmentDetails\n  characterArc CharacterArc\n  physicalDescription PhysicalDescription\n  dialogueVoice DialogueVoice\n  relationships CharacterRelationship[]\n  generationMetadata CharacterGenerationMetadata\n}\n\nclass CharacterDevelopmentDetails {\n  biography string\n  personality string\n  motivations string\n  backstory string\n  psychology CharacterPsychology\n}\n\nclass CharacterPsychology {\n  motivation string\n  fears string\n  desires string\n  flaws string\n}\n\nclass CharacterArc {\n  startState string\n  transformation string\n  endState string\n}\n\nclass PhysicalDescription {\n  description string\n  age int?\n  height string?\n  eyeColor string?\n  hairColor string?\n  clothing string?\n}\n\nclass DialogueVoice {\n  voiceDescription string\n  style string\n  patterns string\n  vocabulary string\n}\n\nclass CharacterRelationship {\n  character string\n  relationship string\n  dynamic string\n}\n\nclass CharacterGenerationMetadata {\n  generatedAt string\n  generationMethod string\n  qualityScore int\n  completeness int\n}\n\nclass CharacterQualityMetrics {\n  overallQuality int\n  characterDepth int\n  arcConsistency int\n  relationshipClarity int\n  dialogueDistinction int\n  psychologicalRealism int\n}\n\n// Main function to develop characters from story structure\nfunction DevelopCharacters(\n  storyContent: string,\n  projectName: string,\n  movieFormat: string,\n  movieStyle: string,\n  durationUnit: int,\n  primaryGenres: string[],\n  targetAudience: string[],\n  characterArcs: string[], // From story structure\n  storyBeats: string[] // Key story beats for character presence\n) -> CharacterDevelopmentResponse {\n  client OpenRouterAdvanced\n  prompt #\"\n    You are a master character development specialist and psychology expert with deep understanding of character creation, personality development, and dramatic storytelling. Your task is to create comprehensive, psychologically realistic character profiles based on the provided story content and structure, optimized for the specific duration format.\n\n    STORY CONTENT:\n    {{ storyContent }}\n\n    DURATION-ADAPTIVE CHARACTER DEVELOPMENT CONSTRAINTS:\n    {% if durationUnit <= 2 %}\n    MICRO-FORMAT CHARACTER REQUIREMENTS ({{ durationUnit }} minutes):\n    - Character Count: 1-2 maximum (focus on single protagonist)\n    - Development Depth: Essential traits only - no extensive backstory\n    - Character Arc: Single moment of change or realization\n    - Psychology: One primary motivation/conflict\n    - Relationships: Minimal - focus on internal or single external relationship\n    - Dialogue Voice: Distinctive but minimal - character shown through action\n    - Physical Description: Key visual elements only\n    - Backstory: Only what's essential to understand the moment\n    {% elif durationUnit <= 5 %}\n    ULTRA-SHORT CHARACTER REQUIREMENTS ({{ durationUnit }} minutes):\n    - Character Count: 2-3 maximum (protagonist + 1-2 others)\n    - Development Depth: Core traits and primary motivation\n    - Character Arc: Simple but clear transformation\n    - Psychology: Primary motivation with one key conflict/fear\n    - Relationships: 1-2 key relationships that drive story\n    - Dialogue Voice: Distinct and efficient\n    - Physical Description: Essential visual characteristics\n    - Backstory: Minimal but sufficient for character understanding\n    {% elif durationUnit <= 30 %}\n    SHORT FILM CHARACTER REQUIREMENTS ({{ durationUnit }} minutes):\n    - Character Count: 3-5 maximum (protagonist + supporting cast)\n    - Development Depth: Well-developed core traits and motivations\n    - Character Arc: Traditional character growth with clear progression\n    - Psychology: Primary and secondary motivations, key fears/desires\n    - Relationships: 2-3 meaningful relationships affecting story\n    - Dialogue Voice: Distinctive speech patterns and vocabulary\n    - Physical Description: Detailed appearance supporting character\n    - Backstory: Sufficient depth for character consistency\n    {% elif durationUnit <= 60 %}\n    MEDIUM FORMAT CHARACTER REQUIREMENTS ({{ durationUnit }} minutes):\n    - Character Count: 4-8 (protagonist + developed supporting characters)\n    - Development Depth: Full psychological profiles with complexity\n    - Character Arc: Complete transformation with multiple growth phases\n    - Psychology: Complex motivations, fears, desires, and flaws\n    - Relationships: Multiple interconnected relationships\n    - Dialogue Voice: Rich, distinctive speech patterns\n    - Physical Description: Comprehensive appearance and mannerisms\n    - Backstory: Detailed history informing current behavior\n    {% elif durationUnit <= 120 %}\n    FEATURE LENGTH CHARACTER REQUIREMENTS ({{ durationUnit }} minutes):\n    - Character Count: 6-12 (complex character ensemble)\n    - Development Depth: Deep psychological complexity and nuance\n    - Character Arc: Multi-layered transformation with setbacks and growth\n    - Psychology: Intricate psychological makeup with contradictions\n    - Relationships: Complex web of relationships affecting all characters\n    - Dialogue Voice: Highly distinctive and evolved speech patterns\n    - Physical Description: Detailed physical presence and evolution\n    - Backstory: Rich personal history with formative experiences\n    {% else %}\n    EXTENDED FORMAT CHARACTER REQUIREMENTS ({{ durationUnit }} minutes):\n    - Character Count: 8-20+ (epic ensemble with multiple protagonists)\n    - Development Depth: Epic character complexity across extended narrative\n    - Character Arc: Multiple transformation phases, generational changes\n    - Psychology: Deep psychological exploration with evolution over time\n    - Relationships: Extensive relationship networks across storylines\n    - Dialogue Voice: Evolving speech patterns showing character growth\n    - Physical Description: Physical evolution throughout extended narrative\n    - Backstory: Comprehensive personal histories spanning generations/time\n    {% endif %}\n\n    PROJECT CONTEXT:\n    - Project Name: {{ projectName }}\n    - Format: {{ movieFormat }}\n    - Style: {{ movieStyle }}\n    - Duration: {{ durationUnit }} minutes\n    - Genres: {{ primaryGenres|join(\", \") }}\n    - Target Audience: {{ targetAudience|join(\", \") }}\n\n    CHARACTER ARCS FROM STORY STRUCTURE:\n    {% for arc in characterArcs %}\n    - {{ arc }}\n    {% endfor %}\n\n    KEY STORY BEATS:\n    {% for beat in storyBeats %}\n    - {{ beat }}\n    {% endfor %}\n\n    TASK: Create detailed character profiles for all major characters identified in the story. For each character, develop:\n\n    1. BASIC INFORMATION:\n    - Name and role (protagonist, antagonist, supporting, minor)\n    - Character archetype (Hero, Mentor, Trickster, etc.)\n\n    2. CHARACTER DEVELOPMENT:\n    - Biography: Comprehensive background and life history\n    - Personality: Core traits, behaviors, and characteristics\n    - Motivations: What drives the character throughout the story\n    - Backstory: Formative experiences that shaped the character\n    - Psychology: Deep dive into motivation, fears, desires, and flaws\n\n    3. CHARACTER ARC:\n    - Starting state: How the character begins the story\n    - Transformation: How they change and grow\n    - Ending state: Where they end up by story's conclusion\n\n    4. PHYSICAL DESCRIPTION:\n    - Overall appearance and distinctive features\n    - Age, height, eye color, hair color\n    - Typical clothing and style choices\n    - Physical mannerisms and presence\n\n    5. DIALOGUE VOICE:\n    - Speaking style and voice characteristics\n    - Speech patterns and verbal mannerisms\n    - Vocabulary level and word choices\n    - How their dialogue differs from other characters\n\n    6. RELATIONSHIPS:\n    - Key relationships with other characters\n    - Relationship dynamics and interaction styles\n    - How relationships evolve throughout the story\n\n    QUALITY REQUIREMENTS:\n    - Characters must feel psychologically realistic and three-dimensional\n    - Each character should have a distinct voice and personality\n    - Character arcs should align with the story structure\n    - Relationships should create meaningful dramatic tension\n    - All characters should serve the story's themes and genre expectations\n    - Consider the target audience when developing character appeal\n\n    GENRE CONSIDERATIONS:\n    {% for genre in primaryGenres %}\n    - {{ genre }}: Ensure characters fit genre conventions while remaining original\n    {% endfor %}\n\n    FORMAT CONSIDERATIONS:\n    - {{ movieFormat }}: Character development should suit the format's pacing and scope\n    - {{ durationUnit }} minutes: Character arcs must fit within time constraints\n\n    Generate comprehensive character profiles that will serve as the foundation for screenplay development. Focus on creating characters that are memorable, relatable, and dramatically compelling.\n\n    Return your response in the exact JSON format specified by the CharacterDevelopmentResponse class.\n  \"#\n}\n\n// Function to enhance existing characters with additional details\nfunction EnhanceCharacterProfiles(\n  existingCharacters: string[], // JSON string of existing character data\n  storyContent: string,\n  focusAreas: string[] // Areas to enhance: dialogue, relationships, psychology, etc.\n) -> CharacterDevelopmentResponse {\n  client OpenRouterAdvanced\n  prompt #\"\n    You are a character development specialist focused on enhancing and deepening existing character profiles. Your task is to take the provided character data and enhance specific areas to create more compelling, three-dimensional characters.\n\n    EXISTING CHARACTERS:\n    {{ existingCharacters }}\n\n    STORY CONTENT FOR REFERENCE:\n    {{ storyContent }}\n\n    FOCUS AREAS FOR ENHANCEMENT:\n    {% for area in focusAreas %}\n    - {{ area }}\n    {% endfor %}\n\n    TASK: Enhance the existing character profiles by:\n\n    1. DEEPENING PSYCHOLOGY: Add layers to character motivations, fears, and internal conflicts\n    2. REFINING DIALOGUE VOICE: Make each character's speaking style more distinct and memorable\n    3. STRENGTHENING RELATIONSHIPS: Develop more complex, nuanced character dynamics\n    4. EXPANDING BACKSTORY: Add relevant historical details that inform current behavior\n    5. IMPROVING PHYSICAL PRESENCE: Enhance physical descriptions and mannerisms\n    6. CLARIFYING ARCS: Ensure character transformations are clear and emotionally satisfying\n\n    Focus particularly on the specified enhancement areas while maintaining consistency with the existing character foundation.\n\n    REQUIRED RESPONSE FORMAT:\n    You must return a JSON object with exactly these fields:\n    {\n      \"characters\": [array of enhanced character objects],\n      \"qualityMetrics\": {\n        \"overallQuality\": number (1-100),\n        \"characterDepth\": number (1-100),\n        \"arcConsistency\": number (1-100),\n        \"relationshipClarity\": number (1-100),\n        \"dialogueDistinction\": number (1-100),\n        \"psychologicalRealism\": number (1-100)\n      },\n      \"generationNotes\": \"string describing the enhancements made\"\n    }\n\n    Return enhanced character profiles in the exact JSON format specified by the CharacterDevelopmentResponse class.\n  \"#\n}\n\n// Function to validate character consistency across story beats\nfunction ValidateCharacterConsistency(\n  characters: string[], // JSON string of character data\n  storyBeats: string[], // Story beats to check against\n  storyContent: string\n) -> CharacterQualityMetrics {\n  client OpenRouterAdvanced\n  prompt #\"\n    You are a character consistency analyst with expertise in narrative coherence and character development. Your task is to evaluate how well the developed characters align with their presence and behavior in the story content and beats.\n\n    CHARACTERS TO VALIDATE:\n    {{ characters }}\n\n    STORY BEATS:\n    {% for beat in storyBeats %}\n    - {{ beat }}\n    {% endfor %}\n\n    STORY CONTENT:\n    {{ storyContent }}\n\n    EVALUATION CRITERIA:\n    1. CHARACTER DEPTH (1-100): How well-developed and three-dimensional are the characters?\n    2. ARC CONSISTENCY (1-100): Do character arcs align with their story journey?\n    3. RELATIONSHIP CLARITY (1-100): Are character relationships clear and well-defined?\n    4. DIALOGUE DISTINCTION (1-100): Does each character have a unique voice?\n    5. PSYCHOLOGICAL REALISM (1-100): Are character motivations and behaviors believable?\n    6. OVERALL QUALITY (1-100): Composite score of character development quality\n\n    Analyze each character against these criteria and provide detailed scoring with justification.\n\n    REQUIRED RESPONSE FORMAT:\n    You must return a JSON object with exactly these fields:\n    {\n      \"overallQuality\": number (1-100),\n      \"characterDepth\": number (1-100),\n      \"arcConsistency\": number (1-100),\n      \"relationshipClarity\": number (1-100),\n      \"dialogueDistinction\": number (1-100),\n      \"psychologicalRealism\": number (1-100)\n    }\n\n    Return your assessment in the exact JSON format specified by the CharacterQualityMetrics class.\n  \"#\n}\n",
  "clients.baml": "client<llm> OpenRouterClient {\r\n  provider openai\r\n  options {\r\n    base_url env.OPENROUTER_BASE_URL\r\n    api_key env.OPENROUTER_API_KEY\r\n    model \"anthropic/claude-sonnet-4\"\r\n    default_headers {\r\n      \"HTTP-Referer\" \"https://localhost:3000\"\r\n      \"X-Title\" \"Novel Movie\"\r\n    }\r\n  }\r\n}\r\n\r\nclient<llm> OpenRouterAdvanced {\r\n  provider openai\r\n  options {\r\n    base_url env.OPENROUTER_BASE_URL\r\n    api_key env.OPENROUTER_API_KEY\r\n    model \"google/gemini-2.5-pro\"\r\n    default_headers {\r\n      \"HTTP-Referer\" \"https://localhost:3000\"\r\n      \"X-Title\" \"Novel Movie\"\r\n    }\r\n  }\r\n}\r\n",
  "project_autofill.baml": "// Project Title Generation - Creative Writer Role\r\nfunction GenerateProjectTitle(\r\n  projectName: string,\r\n  movieFormat: string,\r\n  movieStyle: string,\r\n  series: string?,\r\n  durationUnit: int,\r\n  existingTitle: string?,\r\n  existingShortDescription: string?,\r\n  existingLongDescription: string?\r\n) -> string {\r\n  client OpenRouterClient\r\n  prompt #\"\r\n    You are a creative writer specializing in compelling movie titles. Your task is to generate an engaging, memorable title for a movie project.\r\n\r\n    Project Context:\r\n    - Project Name: {{ projectName }}\r\n    - Movie Format: {{ movieFormat }}\r\n    - Movie Style: {{ movieStyle }}\r\n    {% if series %}\r\n    - Series: {{ series }}\r\n    {% endif %}\r\n    - Duration: {{ durationUnit }} minutes\r\n    \r\n    {% if existingTitle %}\r\n    - Current Title: {{ existingTitle }}\r\n    {% endif %}\r\n    {% if existingShortDescription %}\r\n    - Short Description: {{ existingShortDescription }}\r\n    {% endif %}\r\n    {% if existingLongDescription %}\r\n    - Long Description: {{ existingLongDescription }}\r\n    {% endif %}\r\n\r\n    Guidelines:\r\n    - Create a title that captures the essence and tone of the project\r\n    - Consider the movie format and style when crafting the title\r\n    - Make it memorable and marketable\r\n    - Keep it concise but impactful\r\n    - Ensure it fits the genre and style specified\r\n    {% if series %}\r\n    - Consider this is part of a series: {{ series }}\r\n    {% endif %}\r\n\r\n    Generate only the title, no additional text or explanation.\r\n  \"#\r\n}\r\n\r\n// Short Description Generation - Marketing Content Editor Role\r\nfunction GenerateShortDescription(\r\n  projectName: string,\r\n  movieFormat: string,\r\n  movieStyle: string,\r\n  series: string?,\r\n  durationUnit: int,\r\n  projectTitle: string?,\r\n  existingShortDescription: string?,\r\n  existingLongDescription: string?\r\n) -> string {\r\n  client OpenRouterClient\r\n  prompt #\"\r\n    You are a marketing content editor specializing in compelling movie descriptions for promotional materials. Your task is to create a concise, engaging short description that would work for movie posters, streaming platforms, and marketing materials.\r\n\r\n    Project Context:\r\n    - Project Name: {{ projectName }}\r\n    {% if projectTitle %}\r\n    - Title: {{ projectTitle }}\r\n    {% endif %}\r\n    - Movie Format: {{ movieFormat }}\r\n    - Movie Style: {{ movieStyle }}\r\n    {% if series %}\r\n    - Series: {{ series }}\r\n    {% endif %}\r\n    - Duration: {{ durationUnit }} minutes\r\n    \r\n    {% if existingShortDescription %}\r\n    - Current Short Description: {{ existingShortDescription }}\r\n    {% endif %}\r\n    {% if existingLongDescription %}\r\n    - Long Description: {{ existingLongDescription }}\r\n    {% endif %}\r\n\r\n    Guidelines:\r\n    - Write a compelling 1-2 sentence description (50-100 words maximum)\r\n    - Focus on the hook that would make audiences want to watch\r\n    - Include the genre/style elements naturally\r\n    - Make it suitable for marketing materials\r\n    - Create intrigue without spoiling key plot points\r\n    - Match the tone of the specified movie style\r\n    {% if series %}\r\n    - Consider this is part of a series: {{ series }}\r\n    {% endif %}\r\n\r\n    Generate only the short description, no additional text or explanation.\r\n  \"#\r\n}\r\n\r\n// Long Description Generation - Movie Screenwriter Role\r\nfunction GenerateLongDescription(\r\n  projectName: string,\r\n  movieFormat: string,\r\n  movieStyle: string,\r\n  series: string?,\r\n  durationUnit: int,\r\n  projectTitle: string?,\r\n  existingShortDescription: string?,\r\n  existingLongDescription: string?\r\n) -> string {\r\n  client OpenRouterAdvanced\r\n  prompt #\"\r\n    You are an experienced movie screenwriter and story developer. Your task is to create a detailed, rich description that could serve as the foundation for a screenplay or detailed project synopsis.\r\n\r\n    Project Context:\r\n    - Project Name: {{ projectName }}\r\n    {% if projectTitle %}\r\n    - Title: {{ projectTitle }}\r\n    {% endif %}\r\n    - Movie Format: {{ movieFormat }}\r\n    - Movie Style: {{ movieStyle }}\r\n    {% if series %}\r\n    - Series: {{ series }}\r\n    {% endif %}\r\n    - Duration: {{ durationUnit }} minutes\r\n    \r\n    {% if existingShortDescription %}\r\n    - Short Description: {{ existingShortDescription }}\r\n    {% endif %}\r\n    {% if existingLongDescription %}\r\n    - Current Long Description: {{ existingLongDescription }}\r\n    {% endif %}\r\n\r\n    Guidelines:\r\n    - Create a comprehensive description (200-400 words)\r\n    - Include character archetypes and motivations\r\n    - Outline the main story arc and conflict\r\n    - Describe the setting and atmosphere\r\n    - Include thematic elements that match the movie style\r\n    - Consider the runtime when planning story complexity\r\n    - Make it cinematically viable and engaging\r\n    - Include visual and emotional elements that would translate well to screen\r\n    {% if series %}\r\n    - Consider how this fits within the broader series: {{ series }}\r\n    - Include elements that could connect to other episodes/installments\r\n    {% endif %}\r\n\r\n    Structure the description with:\r\n    1. Setting and premise\r\n    2. Main characters and their goals\r\n    3. Central conflict or challenge\r\n    4. Key story beats\r\n    5. Thematic elements\r\n\r\n    Generate only the long description, no additional text or explanation.\r\n  \"#\r\n}\r\n\r\n// Batch Generation Function - Generates all fields at once\r\nfunction GenerateAllProjectFields(\r\n  projectName: string,\r\n  movieFormat: string,\r\n  movieStyle: string,\r\n  series: string?,\r\n  durationUnit: int,\r\n  existingTitle: string?,\r\n  existingShortDescription: string?,\r\n  existingLongDescription: string?,\r\n  primaryGenres: string[]?,\r\n  corePremise: string?,\r\n  targetAudience: string[]?,\r\n  tone: string[]?\r\n) -> ProjectFieldsResponse {\r\n  client OpenRouterAdvanced\r\n  prompt #\"\r\n    You are a comprehensive movie development team including a creative writer, marketing content editor, and screenwriter. Generate all missing project fields for this movie project.\r\n\r\n    Project Context:\r\n    - Project Name: {{ projectName }}\r\n    - Movie Format: {{ movieFormat }}\r\n    - Movie Style: {{ movieStyle }}\r\n    {% if series %}\r\n    - Series: {{ series }}\r\n    {% endif %}\r\n    - Duration: {{ durationUnit }} minutes\r\n\r\n    Core Story Elements:\r\n    {% if primaryGenres %}\r\n    - Genres: {{ primaryGenres | join(\", \") }}\r\n    {% endif %}\r\n    {% if corePremise %}\r\n    - Core Premise: {{ corePremise }}\r\n    {% endif %}\r\n    {% if targetAudience %}\r\n    - Target Audience: {{ targetAudience | join(\", \") }}\r\n    {% endif %}\r\n    {% if tone %}\r\n    - Tone: {{ tone | join(\", \") }}\r\n    {% endif %}\r\n    \r\n    Existing Content:\r\n    {% if existingTitle %}\r\n    - Title: {{ existingTitle }}\r\n    {% endif %}\r\n    {% if existingShortDescription %}\r\n    - Short Description: {{ existingShortDescription }}\r\n    {% endif %}\r\n    {% if existingLongDescription %}\r\n    - Long Description: {{ existingLongDescription }}\r\n    {% endif %}\r\n\r\n    Generate the missing fields with these roles:\r\n    - Title: Creative writer creating memorable, marketable titles\r\n    - Short Description: Marketing editor creating compelling 50-100 word promotional copy\r\n    - Long Description: Screenwriter creating detailed 200-400 word story synopsis\r\n\r\n    Ensure all generated content is cohesive and consistent with each other and the project parameters.\r\n\r\n    Return the response in the exact JSON format specified by ProjectFieldsResponse.\r\n  \"#\r\n}\r\n\r\nclass ProjectFieldsResponse {\r\n  projectTitle string?\r\n  shortDescription string?\r\n  longDescription string?\r\n}\r\n",
  "project_core_elements.baml": "// Project Core Story Elements Auto-fill BAML Templates\r\n// Simple functions for generating core story elements in project creation form\r\n\r\n// Simple Core Premise Generation - Story Development Expert\r\nfunction GenerateSimpleCorePremise(\r\n  projectName: string,\r\n  movieFormat: string,\r\n  movieStyle: string,\r\n  series: string?,\r\n  durationUnit: int,\r\n  primaryGenres: string[],\r\n  existingPremise: string?\r\n) -> string {\r\n  client OpenRouterAdvanced\r\n  prompt #\"\r\n    You are a master story architect specializing in concise, compelling story premises. Your task is to create a simple, clear core premise for this project.\r\n\r\n    Project Context:\r\n    - Project Name: {{ projectName }}\r\n    - Movie Format: {{ movieFormat }}\r\n    - Movie Style: {{ movieStyle }}\r\n    {% if series %}\r\n    - Series: {{ series }}\r\n    {% endif %}\r\n    - Duration: {{ durationUnit }} minutes\r\n    - Primary Genres: {{ primaryGenres|join(\", \") }}\r\n\r\n    {% if existingPremise %}\r\n    Current Premise: {{ existingPremise }}\r\n    {% endif %}\r\n\r\n    Instructions:\r\n    - Create a compelling core premise in exactly 1-2 clear, concise sentences\r\n    - Focus on the central conflict and what drives the story forward\r\n    - Incorporate elements that align with the selected genres\r\n    - Consider the format and duration when crafting the scope\r\n    - Make it specific and engaging without being overly complex\r\n    - Avoid clichÃ©s and strive for originality within genre conventions\r\n\r\n    CRITICAL: Return ONLY the premise text as 1-2 sentences. No formatting, headers, explanations, introductions, or additional text. Just the core story premise as plain text.\r\n  \"#\r\n}\r\n\r\n// Primary Genres Generation - Genre Expert\r\nfunction GeneratePrimaryGenres(\r\n  projectName: string,\r\n  movieFormat: string,\r\n  movieStyle: string,\r\n  series: string?,\r\n  durationUnit: int,\r\n  existingGenres: string[]?\r\n) -> string[] {\r\n  client OpenRouterAdvanced\r\n  prompt #\"\r\n    You are a genre classification expert with deep knowledge of film and television categorization. Your task is to select exactly 3 primary genres that best fit this project based on the provided context.\r\n\r\n    Project Context:\r\n    - Project Name: {{ projectName }}\r\n    - Movie Format: {{ movieFormat }}\r\n    - Movie Style: {{ movieStyle }}\r\n    {% if series %}\r\n    - Series: {{ series }}\r\n    {% endif %}\r\n    - Duration: {{ durationUnit }} minutes\r\n\r\n    {% if existingGenres %}\r\n    Current Genres: {{ existingGenres|join(\", \") }}\r\n    {% endif %}\r\n\r\n    Available Genres:\r\n    Action, Adventure, Animation, Biography, Comedy, Crime, Documentary, Drama, Family, Fantasy, History, Horror, Music, Mystery, Romance, Sci-Fi, Sport, Thriller, War, Western\r\n\r\n    Instructions:\r\n    - Select exactly 3 genres that best represent this project\r\n    - Consider the movie format, style, and duration when making selections\r\n    - Choose genres that work well together and create compelling storytelling opportunities\r\n    - Prioritize genres that align with the movie style and format\r\n    - For series format, consider genres that sustain long-form storytelling\r\n    - For shorter durations, focus on genres that work well in condensed formats\r\n\r\n    Return only a JSON array of exactly 3 genre names, no additional text or explanation.\r\n    Example: [\"Drama\", \"Thriller\", \"Mystery\"]\r\n  \"#\r\n}\r\n\r\n// Target Audience Generation - Audience Research Expert\r\nfunction GenerateTargetAudience(\r\n  projectName: string,\r\n  primaryGenres: string[],\r\n  corePremise: string,\r\n  movieFormat: string,\r\n  durationUnit: int,\r\n  existingAudience: string[]?\r\n) -> string[] {\r\n  client OpenRouterAdvanced\r\n  prompt #\"\r\n    You are an audience research and demographic targeting expert. Your task is to identify the most suitable target audience segments for this project.\r\n\r\n    Project Context:\r\n    - Project Name: {{ projectName }}\r\n    - Primary Genres: {{ primaryGenres|join(\", \") }}\r\n    - Core Premise: {{ corePremise }}\r\n    - Movie Format: {{ movieFormat }}\r\n    - Duration: {{ durationUnit }} minutes\r\n\r\n    {% if existingAudience %}\r\n    Current Target Audience: {{ existingAudience|join(\", \") }}\r\n    {% endif %}\r\n\r\n    Available Audience Demographics:\r\n    Children (5-12), Teens (13-17), Young Adults (18-24), Adults (25-34), Middle-aged Adults (35-49), Older Adults (50-64), Seniors (65+), Families, General Audience\r\n\r\n    Instructions:\r\n    - Select 2-3 audience demographics that best match this project\r\n    - Consider the genres, premise, and format when determining audience appeal\r\n    - Think about who would be most interested in and engaged by this story\r\n    - Consider content appropriateness for different age groups\r\n    - For family content, include \"Families\" as one of the demographics\r\n    - Balance broad appeal with targeted specificity\r\n\r\n    Return only a JSON array of 2-3 demographic names, no additional text or explanation.\r\n    Example: [\"Young Adults (18-24)\", \"Adults (25-34)\", \"General Audience\"]\r\n  \"#\r\n}\r\n\r\n// Tone Generation - Narrative Tone Expert\r\nfunction GenerateTone(\r\n  projectName: string,\r\n  primaryGenres: string[],\r\n  corePremise: string,\r\n  targetAudience: string[],\r\n  movieStyle: string,\r\n  existingTone: string[]?\r\n) -> string[] {\r\n  client OpenRouterAdvanced\r\n  prompt #\"\r\n    You are a narrative tone specialist with expertise in defining how stories are told. Your task is to select appropriate tones that will guide the storytelling approach and narrative style.\r\n\r\n    Project Context:\r\n    - Project Name: {{ projectName }}\r\n    - Primary Genres: {{ primaryGenres|join(\", \") }}\r\n    - Core Premise: {{ corePremise }}\r\n    - Target Audience: {{ targetAudience|join(\", \") }}\r\n    - Movie Style: {{ movieStyle }}\r\n\r\n    {% if existingTone %}\r\n    Current Tone: {{ existingTone|join(\", \") }}\r\n    {% endif %}\r\n\r\n    Available Narrative Tones:\r\n    Serious, Comedic, Dramatic, Suspenseful, Romantic, Action-packed, Mysterious, Inspirational, Satirical, Gritty, Whimsical, Intense, Contemplative, Adventurous, Surreal, Realistic\r\n\r\n    Instructions:\r\n    - Select 1-2 tones that define HOW the story is told (narrative approach)\r\n    - Focus on storytelling style, not emotional atmosphere\r\n    - Ensure the tones complement the genres and premise\r\n    - Consider how these tones will guide dialogue, pacing, and narrative structure\r\n    - Choose tones that work well together and don't conflict\r\n    - Align with the movie style and overall project vision\r\n\r\n    Return only a JSON array of 1-2 tone names, no additional text or explanation.\r\n    Example: [\"Dramatic\", \"Suspenseful\"]\r\n  \"#\r\n}\r\n\r\n// Mood Generation - Emotional Atmosphere Expert\r\nfunction GenerateMood(\r\n  projectName: string,\r\n  primaryGenres: string[],\r\n  corePremise: string,\r\n  targetAudience: string[],\r\n  movieStyle: string,\r\n  selectedTones: string[]?,\r\n  existingMood: string[]?\r\n) -> string[] {\r\n  client OpenRouterAdvanced\r\n  prompt #\"\r\n    You are an emotional atmosphere specialist with expertise in crafting the emotional feeling and mood of stories. Your task is to select appropriate moods that will define the emotional atmosphere audiences will experience.\r\n\r\n    Project Context:\r\n    - Project Name: {{ projectName }}\r\n    - Primary Genres: {{ primaryGenres|join(\", \") }}\r\n    - Core Premise: {{ corePremise }}\r\n    - Target Audience: {{ targetAudience|join(\", \") }}\r\n    - Movie Style: {{ movieStyle }}\r\n    {% if selectedTones %}\r\n    - Selected Narrative Tones: {{ selectedTones|join(\", \") }}\r\n    {% endif %}\r\n\r\n    {% if existingMood %}\r\n    Current Mood: {{ existingMood|join(\", \") }}\r\n    {% endif %}\r\n\r\n    Available Emotional Moods:\r\n    Optimistic, Melancholic, Tense, Hopeful, Brooding, Energetic, Contemplative, Anxious, Peaceful, Chaotic, Nostalgic, Triumphant, Mysterious, Dark, Uplifting, Somber, Playful, Intense, Serene, Foreboding\r\n\r\n    Instructions:\r\n    - Select 1-2 moods that define the EMOTIONAL ATMOSPHERE and feeling\r\n    - Focus on what emotions the audience should feel, not how the story is told\r\n    - Ensure the moods complement the selected narrative tones and genres\r\n    - Consider the target audience's emotional preferences\r\n    - Choose moods that work well together and create a cohesive emotional experience\r\n    - Think about the overall emotional journey the audience will take\r\n\r\n    Return only a JSON array of 1-2 mood names, no additional text or explanation.\r\n    Example: [\"Optimistic\", \"Tense\"]\r\n  \"#\r\n}\r\n",
  "story_generation.baml": "// Story Generation BAML Templates\r\n// Comprehensive story generation using all project data\r\n\r\n// Response type for initial story generation\r\nclass InitialStoryResponse {\r\n  storyContent string\r\n  qualityMetrics QualityMetrics\r\n  generationNotes string\r\n}\r\n\r\nclass QualityMetrics {\r\n  overallQuality int\r\n  structureScore int\r\n  characterDepth int\r\n  coherenceScore int\r\n  conflictTension int\r\n  dialogueQuality int\r\n  genreAlignment int\r\n  audienceEngagement int\r\n  visualStorytelling int\r\n  productionReadiness int\r\n}\r\n\r\n// Main story generation function using all project fields\r\nfunction GenerateInitialStory(\r\n  projectName: string,\r\n  projectTitle: string?,\r\n  shortDescription: string?,\r\n  longDescription: string?,\r\n  movieFormat: string,\r\n  movieStyle: string,\r\n  durationUnit: int,\r\n  primaryGenres: string[],\r\n  corePremise: string,\r\n  targetAudience: string[],\r\n  tone: string[]\r\n) -> InitialStoryResponse {\r\n  client OpenRouterAdvanced\r\n  prompt #\"\r\n    You are a master storyteller and screenplay architect with expertise in creating compelling narratives across all genres and formats. Your task is to generate a comprehensive initial story that will serve as the foundation for iterative enhancement.\r\n\r\n    PROJECT DETAILS:\r\n    - Project Name: {{ projectName }}\r\n    {% if projectTitle %}\r\n    - Project Title: {{ projectTitle }}\r\n    {% endif %}\r\n    {% if shortDescription %}\r\n    - Brief Description: {{ shortDescription }}\r\n    {% endif %}\r\n    {% if longDescription %}\r\n    - Detailed Synopsis: {{ longDescription }}\r\n    {% endif %}\r\n    - Format: {{ movieFormat }}\r\n    - Visual Style: {{ movieStyle }}\r\n    - Duration: {{ durationUnit }} minutes\r\n    - Primary Genres: {{ primaryGenres|join(\", \") }}\r\n    - Core Premise: {{ corePremise }}\r\n    - Target Audience: {{ targetAudience|join(\", \") }}\r\n    - Tone: {{ tone|join(\", \") }}\r\n\r\n    DURATION-ADAPTIVE GENERATION REQUIREMENTS:\r\n    {% if durationUnit <= 2 %}\r\n    MICRO-FORMAT REQUIREMENTS ({{ durationUnit }} minutes):\r\n    1. Create single powerful moment or conflict with immediate impact\r\n    2. Develop 1-2 characters with clear, simple motivations\r\n    3. Focus on one core genre element - avoid mixing\r\n    4. Tailor for immediate audience engagement and emotional payoff\r\n    5. Maintain consistent tone throughout (no tonal shifts)\r\n    6. Visual style must be immediately apparent and impactful\r\n    7. Every second must advance the core conflict\r\n    8. Minimal dialogue - focus on visual storytelling\r\n    9. Single relationship dynamic or internal conflict\r\n    10. High cinematic impact through visual efficiency\r\n    {% elif durationUnit <= 5 %}\r\n    ULTRA-SHORT REQUIREMENTS ({{ durationUnit }} minutes):\r\n    1. Create compressed three-act structure with rapid progression\r\n    2. Develop 2-3 characters with clear, focused arcs\r\n    3. Respect primary genre conventions, minimal secondary elements\r\n    4. Quick audience connection with immediate stakes\r\n    5. Consistent tone with possible single tonal shift\r\n    6. Visual style supports rapid story development\r\n    7. Efficient pacing - every moment serves story\r\n    8. Dialogue must be essential and character-revealing\r\n    9. Simple but compelling character relationships\r\n    10. Strong cinematic moments within time constraints\r\n    {% elif durationUnit <= 30 %}\r\n    SHORT FILM REQUIREMENTS ({{ durationUnit }} minutes):\r\n    1. Traditional three-act structure with compressed development\r\n    2. Develop 3-5 characters with meaningful growth\r\n    3. Blend genre elements while maintaining focus\r\n    4. Build audience investment through character development\r\n    5. Allow for tonal range while maintaining consistency\r\n    6. Visual style enhances narrative and character arcs\r\n    7. Balanced pacing with proper story development time\r\n    8. Dialogue serves character and plot advancement\r\n    9. Develop meaningful character relationships and conflicts\r\n    10. Full cinematic storytelling within format constraints\r\n    {% elif durationUnit <= 60 %}\r\n    MEDIUM FORMAT REQUIREMENTS ({{ durationUnit }} minutes):\r\n    1. Complete story structure with full character arcs\r\n    2. Develop 4-8 characters with distinct motivations and growth\r\n    3. Explore genre conventions with creative variations\r\n    4. Build deep audience investment and emotional connection\r\n    5. Rich tonal range supporting story themes\r\n    6. Visual style integral to storytelling and character development\r\n    7. Deliberate pacing allowing for character exploration\r\n    8. Substantial dialogue revealing character depth\r\n    9. Complex character relationships driving story forward\r\n    10. Full cinematic potential with subplot development\r\n    {% elif durationUnit <= 120 %}\r\n    FEATURE LENGTH REQUIREMENTS ({{ durationUnit }} minutes):\r\n    1. Complex multi-layered story structure with interconnected elements\r\n    2. Develop 6-12 characters with full psychological depth\r\n    3. Master genre conventions while adding unique innovations\r\n    4. Create sustained audience engagement across full runtime\r\n    5. Rich tonal complexity supporting thematic depth\r\n    6. Visual style as storytelling language throughout\r\n    7. Varied pacing with tension/release cycles\r\n    8. Extensive dialogue showcasing character voices\r\n    9. Intricate character relationships and conflicts\r\n    10. Maximum cinematic storytelling potential\r\n    {% else %}\r\n    EXTENDED FORMAT REQUIREMENTS ({{ durationUnit }} minutes):\r\n    1. Epic narrative structure with multiple interconnected storylines\r\n    2. Develop 8-20+ characters across ensemble cast\r\n    3. Explore multiple genres and innovative storytelling approaches\r\n    4. Maintain audience engagement across extended runtime\r\n    5. Complex tonal journey supporting epic themes\r\n    6. Visual style evolution throughout the narrative\r\n    7. Epic pacing with multiple climactic moments\r\n    8. Extensive character dialogue and development\r\n    9. Multi-generational or complex relationship webs\r\n    10. Cinematic storytelling on epic scale\r\n    {% endif %}\r\n\r\n    DURATION-ADAPTIVE STORY STRUCTURE TEMPLATE:\r\n    {% if durationUnit <= 2 %}\r\n    **MICRO-FORMAT STRUCTURE ({{ durationUnit }} minutes):**\r\n\r\n    **LOGLINE:**\r\n    [Single powerful moment or realization in one sentence]\r\n\r\n    **STORY OVERVIEW:**\r\n    [One paragraph describing the central moment/conflict and its immediate resolution]\r\n\r\n    **CHARACTER FOCUS:**\r\n    **PRIMARY CHARACTER:**\r\n    - Name: [Character name]\r\n    - Situation: [Current state/problem]\r\n    - Moment: [What changes in this brief time]\r\n    - Impact: [Immediate consequence/realization]\r\n\r\n    **SINGLE-MOMENT STRUCTURE:**\r\n    **SETUP ({{ (durationUnit * 0.2)|round(1) }} minutes):** [Immediate situation establishment]\r\n    **CONFLICT/REALIZATION ({{ (durationUnit * 0.6)|round(1) }} minutes):** [Central moment/conflict]\r\n    **RESOLUTION ({{ (durationUnit * 0.2)|round(1) }} minutes):** [Immediate consequence/change]\r\n\r\n    [Beat-by-beat breakdown with visual focus and minimal dialogue]\r\n    {% elif durationUnit <= 5 %}\r\n    **ULTRA-SHORT STRUCTURE ({{ durationUnit }} minutes):**\r\n\r\n    **LOGLINE:**\r\n    [Compelling hook capturing the core conflict in one sentence]\r\n\r\n    **STORY OVERVIEW:**\r\n    [1-2 paragraphs outlining the compressed narrative arc]\r\n\r\n    **CHARACTER PROFILES:**\r\n    **PROTAGONIST:**\r\n    - Name: [Character name]\r\n    - Goal: [What they want]\r\n    - Obstacle: [What stops them]\r\n    - Change: [How they transform]\r\n\r\n    **KEY SUPPORTING CHARACTER:**\r\n    - Name: [Character name]\r\n    - Role: [How they affect the protagonist]\r\n\r\n    **COMPRESSED THREE-ACT STRUCTURE:**\r\n    **ACT I - SETUP ({{ (durationUnit * 0.2)|round(1) }} minutes)**\r\n    **Opening & Inciting Incident:** [Combined setup and story trigger]\r\n    **Plot Point 1:** [Launch into main conflict]\r\n\r\n    **ACT II - CONFRONTATION ({{ (durationUnit * 0.6)|round(1) }} minutes)**\r\n    **Escalation & Midpoint:** [Conflict development and turning point]\r\n    **Crisis:** [Major obstacle/setback]\r\n\r\n    **ACT III - RESOLUTION ({{ (durationUnit * 0.2)|round(1) }} minutes)**\r\n    **Climax & Resolution:** [Final confrontation and immediate resolution]\r\n\r\n    [Scene-by-scene breakdown with efficient dialogue and visual storytelling]\r\n    {% elif durationUnit <= 30 %}\r\n    **SHORT FILM STRUCTURE ({{ durationUnit }} minutes):**\r\n\r\n    **LOGLINE:**\r\n    [Compelling one-sentence story summary with clear stakes]\r\n\r\n    **STORY OVERVIEW:**\r\n    [2-3 paragraphs outlining complete narrative arc with character development]\r\n\r\n    **CHARACTER PROFILES:**\r\n    **PROTAGONIST:**\r\n    - Name: [Character name]\r\n    - Background: [Essential background]\r\n    - Arc: [Character transformation]\r\n    - Goal: [Primary objective]\r\n    - Obstacle: [Main opposition]\r\n\r\n    **ANTAGONIST/OPPOSITION:**\r\n    - Name: [Character name or force]\r\n    - Background: [Relevant background]\r\n    - Role: [How they create conflict]\r\n\r\n    **SUPPORTING CHARACTERS:**\r\n    [2-3 key characters with specific roles]\r\n\r\n    **TRADITIONAL THREE-ACT STRUCTURE:**\r\n    **ACT I - SETUP ({{ (durationUnit * 0.25)|round }} minutes)**\r\n    **Opening Image:** [Tone-setting visual]\r\n    **Inciting Incident:** [Story catalyst]\r\n    **Plot Point 1:** [Launch into Act II]\r\n\r\n    **ACT II - CONFRONTATION ({{ (durationUnit * 0.5)|round }} minutes)**\r\n    **Rising Action:** [Conflict development]\r\n    **Midpoint:** [Major turning point]\r\n    **Plot Point 2:** [Crisis leading to climax]\r\n\r\n    **ACT III - RESOLUTION ({{ (durationUnit * 0.25)|round }} minutes)**\r\n    **Climax:** [Final confrontation]\r\n    **Resolution:** [Conflict resolution]\r\n    **Closing Image:** [Thematic conclusion]\r\n\r\n    [Detailed scene breakdown with character development and dialogue]\r\n    {% elif durationUnit <= 120 %}\r\n    **FEATURE LENGTH STRUCTURE ({{ durationUnit }} minutes):**\r\n\r\n    **LOGLINE:**\r\n    [Compelling hook with clear protagonist, conflict, and stakes]\r\n\r\n    **STORY OVERVIEW:**\r\n    [3-4 paragraphs covering complete narrative with subplots and character arcs]\r\n\r\n    **CHARACTER PROFILES:**\r\n    **PROTAGONIST:**\r\n    - Name: [Character name]\r\n    - Background: [Detailed background and psychology]\r\n    - Arc: [Complete transformation journey]\r\n    - Goal: [Primary and secondary objectives]\r\n    - Obstacles: [Multiple layers of opposition]\r\n\r\n    **ANTAGONIST:**\r\n    - Name: [Character name]\r\n    - Background: [Detailed background and motivation]\r\n    - Methods: [How they create sustained conflict]\r\n    - Arc: [Antagonist development]\r\n\r\n    **SUPPORTING ENSEMBLE:**\r\n    [4-8 key characters with individual arcs and relationships]\r\n\r\n    **COMPLEX THREE-ACT STRUCTURE:**\r\n    **ACT I - SETUP ({{ (durationUnit * 0.25)|round }} minutes)**\r\n    **Opening Image:** [World and tone establishment]\r\n    **Character Introduction:** [Protagonist in normal world]\r\n    **Inciting Incident:** [Story catalyst]\r\n    **Plot Point 1:** [Major story launch]\r\n\r\n    **ACT II - CONFRONTATION ({{ (durationUnit * 0.5)|round }} minutes)**\r\n    **Rising Action:** [Escalating conflicts and obstacles]\r\n    **Midpoint:** [Major revelation or reversal]\r\n    **Complications:** [Subplot development]\r\n    **Plot Point 2:** [Major crisis/dark moment]\r\n\r\n    **ACT III - RESOLUTION ({{ (durationUnit * 0.25)|round }} minutes)**\r\n    **Climax:** [Final confrontation with full stakes]\r\n    **Resolution:** [All storylines resolved]\r\n    **Closing Image:** [Thematic and emotional conclusion]\r\n\r\n    [Comprehensive scene-by-scene breakdown with full character development]\r\n    {% else %}\r\n    **EXTENDED FORMAT STRUCTURE ({{ durationUnit }} minutes):**\r\n\r\n    **LOGLINE:**\r\n    [Epic scope summary capturing multiple storylines and themes]\r\n\r\n    **STORY OVERVIEW:**\r\n    [4-5 paragraphs covering epic narrative scope, multiple protagonists, and thematic depth]\r\n\r\n    **CHARACTER ENSEMBLE:**\r\n    **PRIMARY PROTAGONISTS:**\r\n    [2-4 main characters with complete individual arcs]\r\n\r\n    **SECONDARY PROTAGONISTS:**\r\n    [4-8 important characters with significant development]\r\n\r\n    **ANTAGONIST FORCES:**\r\n    [Multiple layers of opposition and conflict]\r\n\r\n    **SUPPORTING CAST:**\r\n    [Extended ensemble with specific roles and relationships]\r\n\r\n    **EPIC STRUCTURE:**\r\n    **ACT I - WORLD ESTABLISHMENT ({{ (durationUnit * 0.3)|round }} minutes)**\r\n    **Opening Scope:** [Epic world and stakes establishment]\r\n    **Character Introductions:** [Multiple protagonist introductions]\r\n    **Inciting Events:** [Multiple story catalysts]\r\n    **Plot Point 1:** [Major story launches]\r\n\r\n    **ACT II - MULTIPLE CONFRONTATIONS ({{ (durationUnit * 0.45)|round }} minutes)**\r\n    **Parallel Storylines:** [Multiple plot development]\r\n    **Interconnected Conflicts:** [How storylines affect each other]\r\n    **Multiple Midpoints:** [Various turning points]\r\n    **Convergence:** [Storylines coming together]\r\n    **Major Crisis:** [Epic scope crisis]\r\n\r\n    **ACT III - EPIC RESOLUTION ({{ (durationUnit * 0.25)|round }} minutes)**\r\n    **Multiple Climaxes:** [Various storyline climaxes]\r\n    **Epic Confrontation:** [Final large-scale conflict]\r\n    **Resolution Cascade:** [Multiple storyline resolutions]\r\n    **Epic Conclusion:** [Thematic and emotional closure]\r\n\r\n    [Epic scene-by-scene breakdown with multiple character arcs and storylines]\r\n    {% endif %}\r\n\r\n    **VISUAL STYLE INTEGRATION:**\r\n    [How the {{ movieStyle }} style enhances the narrative through cinematography, color palette, and visual metaphors]\r\n\r\n    **GENRE ELEMENTS:**\r\n    [Specific {{ primaryGenres|join(\", \") }} conventions utilized and how they serve the story]\r\n\r\n    **AUDIENCE CONSIDERATIONS:**\r\n    [How the story specifically appeals to {{ targetAudience|join(\", \") }} while maintaining broad appeal]\r\n\r\n    **TONE CONSISTENCY:**\r\n    [How the {{ tone|join(\", \") }} tone is maintained throughout while allowing for emotional range]\r\n\r\n    **DIALOGUE SAMPLES:**\r\n    [Include 3-4 key dialogue exchanges that demonstrate character voice and advance plot]\r\n\r\n    **PRODUCTION NOTES:**\r\n    [Considerations for {{ movieFormat }} format, budget implications, and technical requirements]\r\n\r\n    **THEMATIC DEPTH:**\r\n    [Core themes explored and how they resonate with the target audience]\r\n\r\n    **ENHANCEMENT OPPORTUNITIES:**\r\n    [Areas identified for future iterative improvement in character depth, dialogue, visual storytelling, etc.]\r\n\r\n    Generate a story that is complete, engaging, and ready for iterative enhancement. Focus on creating a solid foundation that maximizes the potential of all provided project elements.\r\n\r\n    IMPORTANT: Return your response in this exact JSON format:\r\n    {\r\n      \"storyContent\": \"[Complete story content as a single string]\",\r\n      \"qualityMetrics\": {\r\n        \"overallQuality\": [number 1-10],\r\n        \"structureScore\": [number 1-10],\r\n        \"characterDepth\": [number 1-10],\r\n        \"coherenceScore\": [number 1-10],\r\n        \"conflictTension\": [number 1-10],\r\n        \"dialogueQuality\": [number 1-10],\r\n        \"genreAlignment\": [number 1-10],\r\n        \"audienceEngagement\": [number 1-10],\r\n        \"visualStorytelling\": [number 1-10],\r\n        \"productionReadiness\": [number 1-10]\r\n      },\r\n      \"generationNotes\": \"[Explanation of key creative decisions and areas for future enhancement]\"\r\n    }\r\n  \"#\r\n}\r\n\r\n// Enhanced story generation with additional context\r\nfunction GenerateStoryWithContext(\r\n  projectData: string,\r\n  additionalContext: string?,\r\n  focusAreas: string[]?\r\n) -> InitialStoryResponse {\r\n  client OpenRouterAdvanced\r\n  prompt #\"\r\n    You are an expert story architect. Generate a comprehensive story using the provided project data.\r\n\r\n    PROJECT DATA:\r\n    {{ projectData }}\r\n\r\n    {% if additionalContext %}\r\n    ADDITIONAL CONTEXT:\r\n    {{ additionalContext }}\r\n    {% endif %}\r\n\r\n    {% if focusAreas %}\r\n    FOCUS AREAS:\r\n    Pay special attention to: {{ focusAreas|join(\", \") }}\r\n    {% endif %}\r\n\r\n    Generate a complete, engaging story following the same comprehensive structure as the main story generation function. Ensure all elements work together cohesively and the story has strong cinematic potential.\r\n  \"#\r\n}\r\n\r\n// Story enhancement function for iterative improvement\r\nfunction EnhanceStory(\r\n  currentStory: string,\r\n  focusArea: string,\r\n  targetMetrics: string[],\r\n  currentQuality: QualityMetrics\r\n) -> InitialStoryResponse {\r\n  client OpenRouterAdvanced\r\n  prompt #\"\r\n    You are a master story editor and enhancement specialist. Your task is to improve an existing story by focusing on specific quality areas while maintaining the core narrative and characters.\r\n\r\n    CURRENT STORY:\r\n    {{ currentStory }}\r\n\r\n    ENHANCEMENT FOCUS: {{ focusArea }}\r\n    TARGET METRICS TO IMPROVE: {{ targetMetrics|join(\", \") }}\r\n\r\n    CURRENT QUALITY SCORES:\r\n    - Overall Quality: {{ currentQuality.overallQuality }}/10\r\n    - Structure Score: {{ currentQuality.structureScore }}/10\r\n    - Character Depth: {{ currentQuality.characterDepth }}/10\r\n    - Coherence Score: {{ currentQuality.coherenceScore }}/10\r\n    - Conflict Tension: {{ currentQuality.conflictTension }}/10\r\n    - Dialogue Quality: {{ currentQuality.dialogueQuality }}/10\r\n    - Genre Alignment: {{ currentQuality.genreAlignment }}/10\r\n    - Audience Engagement: {{ currentQuality.audienceEngagement }}/10\r\n    - Visual Storytelling: {{ currentQuality.visualStorytelling }}/10\r\n    - Production Readiness: {{ currentQuality.productionReadiness }}/10\r\n\r\n    ENHANCEMENT INSTRUCTIONS:\r\n    {% if focusArea == \"Story Structure\" %}\r\n    Focus on improving narrative flow, pacing, three-act structure, plot points, and story beats. Ensure smooth transitions between scenes and clear story progression.\r\n    {% elif focusArea == \"Character Development\" %}\r\n    Deepen character motivations, backstories, relationships, and character arcs. Add more personality, internal conflicts, and character growth throughout the story.\r\n    {% elif focusArea == \"Story Coherence\" %}\r\n    Improve plot consistency, logical flow, cause-and-effect relationships, and eliminate plot holes. Ensure all story elements connect meaningfully.\r\n    {% elif focusArea == \"Conflict & Tension\" %}\r\n    Heighten dramatic tension, raise stakes, intensify conflicts, and create more compelling obstacles. Add urgency and emotional investment.\r\n    {% elif focusArea == \"Dialogue Quality\" %}\r\n    Improve character voice distinctiveness, subtext, naturalness, and dialogue that advances plot and reveals character. Make conversations more engaging and realistic.\r\n    {% elif focusArea == \"Genre Alignment\" %}\r\n    Better incorporate genre conventions, tropes, and expectations while maintaining originality. Ensure the story delivers on genre promises.\r\n    {% elif focusArea == \"Audience Engagement\" %}\r\n    Enhance emotional connection, relatability, and elements that will captivate the target audience. Add hooks and compelling moments.\r\n    {% elif focusArea == \"Visual Storytelling\" %}\r\n    Improve cinematic descriptions, visual metaphors, scene composition, and elements that translate well to screen. Enhance visual narrative.\r\n    {% elif focusArea == \"Production Readiness\" %}\r\n    Optimize for production feasibility, budget considerations, technical requirements, and practical filmmaking needs.\r\n    {% endif %}\r\n\r\n    ENHANCEMENT REQUIREMENTS:\r\n    1. Maintain the core story, characters, and plot structure\r\n    2. Focus specifically on improving the {{ focusArea }} aspect\r\n    3. Enhance the target metrics: {{ targetMetrics|join(\", \") }}\r\n    4. Keep all existing strong elements intact\r\n    5. Make improvements that feel natural and integrated\r\n    6. Ensure the enhanced version flows smoothly\r\n    7. Maintain consistency with established tone and style\r\n    8. Improve quality scores by 1-2 points in target areas\r\n\r\n    Return the enhanced story with the same comprehensive structure as the original, but with focused improvements in the specified area. The enhanced version should feel like a natural evolution of the original story.\r\n\r\n    IMPORTANT: Return your response in this exact JSON format:\r\n    {\r\n      \"storyContent\": \"[Complete enhanced story content as a single string]\",\r\n      \"qualityMetrics\": {\r\n        \"overallQuality\": [improved number 1-10],\r\n        \"structureScore\": [improved number 1-10],\r\n        \"characterDepth\": [improved number 1-10],\r\n        \"coherenceScore\": [improved number 1-10],\r\n        \"conflictTension\": [improved number 1-10],\r\n        \"dialogueQuality\": [improved number 1-10],\r\n        \"genreAlignment\": [improved number 1-10],\r\n        \"audienceEngagement\": [improved number 1-10],\r\n        \"visualStorytelling\": [improved number 1-10],\r\n        \"productionReadiness\": [improved number 1-10]\r\n      },\r\n      \"generationNotes\": \"[Explanation of specific enhancements made and quality improvements achieved]\"\r\n    }\r\n  \"#\r\n}\r\n",
  "story_structure.baml": "// Story Structure Planning BAML Functions\n// Analyzes existing story content and generates structured screenplay elements\n\n// Response types for story structure analysis\nclass StoryStructureResponse {\n  narrativeStructure NarrativeStructure\n  storyBeats StoryBeat[]\n  characterArcs CharacterArc[]\n  subplots Subplot[]\n  qualityScore int?\n  qualityAssessment QualityAssessment?\n  generationNotes string?\n}\n\n// Adaptive narrative structure based on duration\nclass NarrativeStructure {\n  structureType string // \"single-moment\", \"compressed-three-act\", \"traditional-three-act\", \"five-act\", \"save-the-cat\", \"eight-sequence\"\n  adaptiveActs AdaptiveAct[]\n  sequences SequenceStructure[]? // For eight-sequence structure\n  saveTheCatBeats SaveTheCatBeat[]? // For Save the Cat structure\n}\n\nclass AdaptiveAct {\n  actNumber int\n  name string\n  description string\n  duration int\n  keyEvents string[]\n  purpose string\n}\n\nclass SequenceStructure {\n  sequenceNumber int\n  name string\n  description string\n  duration int\n  miniMovieArc string\n  keyBeats string[]\n}\n\nclass SaveTheCatBeat {\n  beatNumber int\n  name string\n  description string\n  pageNumber int\n  timing int\n  purpose string\n}\n\nclass QualityAssessment {\n  overallScore int\n  breakdown QualityBreakdown?\n}\n\nclass QualityBreakdown {\n  clearThreeActProgression QualityMetric?\n  strongCharacterArcs QualityMetric?\n  compellingStoryBeats QualityMetric?\n  effectiveSubplotIntegration QualityMetric?\n  cinematicPotential QualityMetric?\n}\n\nclass QualityMetric {\n  score int\n  justification string?\n}\n\nclass ActStructure {\n  act1 Act\n  act2 Act\n  act3 Act\n}\n\nclass Act {\n  setup string?\n  incitingIncident string?\n  plotPoint1 string?\n  confrontation string?\n  midpoint string?\n  plotPoint2 string?\n  climax string?\n  fallingAction string?\n  resolution string?\n  duration int\n}\n\nclass StoryBeat {\n  beatId int?\n  beat string\n  timestamp string?\n  timing int?\n  description string\n  charactersPresent string[]?\n  characters string[]?\n  emotionalTone string\n}\n\n// CharacterArc class is defined in character_development.baml\n\nclass Subplot {\n  subplotName string?\n  name string?\n  description string\n  resolution string\n  charactersInvolved string[]?\n  involvedCharacters string[]?\n}\n\n// Main function to analyze story and create structure\nfunction AnalyzeStoryStructure(\n  storyContent: string,\n  projectName: string,\n  movieFormat: string,\n  movieStyle: string,\n  durationUnit: int,\n  primaryGenres: string[],\n  targetAudience: string[]\n) -> StoryStructureResponse {\n  client OpenRouterAdvanced\n  prompt #\"\n    You are a master story structure analyst and screenplay architect with deep expertise in three-act structure, character development, and cinematic storytelling. Your task is to analyze the provided story content and create a comprehensive structural breakdown that will serve as the foundation for screenplay development.\n\n    STORY TO ANALYZE:\n    {{ storyContent }}\n\n    PROJECT CONTEXT:\n    - Project Name: {{ projectName }}\n    - Movie Format: {{ movieFormat }}\n    - Movie Style: {{ movieStyle }}\n    - Target Duration: {{ durationUnit }} minutes\n    - Primary Genres: {{ primaryGenres|join(\", \") }}\n    - Target Audience: {{ targetAudience|join(\", \") }}\n\n    DURATION-ADAPTIVE NARRATIVE STRUCTURE:\n    {% if durationUnit <= 2 %}\n    MICRO-FORMAT ({{ durationUnit }} minutes) - SINGLE MOMENT STRUCTURE:\n    - Structure Type: \"single-moment\"\n    - Acts: 3 micro-acts (Setup â Conflict/Revelation â Impact)\n    - Story Beats: 2-4 maximum (every {{ (durationUnit / 3)|round(1) }} minutes)\n    - Characters: 1-2 maximum (focus on single protagonist)\n    - Locations: 1 location only\n    - Narrative Focus: One dramatic moment/realization\n    - Subplots: None - single narrative thread only\n    - Pacing: Immediate story entry, no setup time\n    - Act Structure: 20% setup / 60% conflict-revelation / 20% impact\n    {% elif durationUnit <= 5 %}\n    ULTRA-SHORT ({{ durationUnit }} minutes) - COMPRESSED THREE-ACT:\n    - Structure Type: \"compressed-three-act\"\n    - Acts: 3 acts with rapid progression\n    - Story Beats: 3-6 maximum (every {{ (durationUnit / 5)|round(1) }} minutes)\n    - Characters: 2-3 maximum (protagonist + 1-2 others)\n    - Locations: 1-2 locations maximum\n    - Narrative Focus: Rapid three-act with immediate engagement\n    - Subplots: None - maintain single storyline\n    - Pacing: Quick setup, immediate conflict engagement\n    - Act Structure: 20% setup / 60% confrontation / 20% resolution\n    {% elif durationUnit <= 30 %}\n    SHORT FILM ({{ durationUnit }} minutes) - TRADITIONAL THREE-ACT:\n    - Structure Type: \"traditional-three-act\"\n    - Acts: 3 acts with full character development\n    - Story Beats: 6-12 (every {{ (durationUnit / 10)|round(1) }} minutes)\n    - Characters: 3-5 maximum (protagonist + supporting cast)\n    - Locations: 2-4 locations maximum\n    - Narrative Focus: Classic beginning/middle/end with complete character arc\n    - Subplots: 1 minor subplot maximum, closely tied to main story\n    - Pacing: Efficient setup, sustained conflict development\n    - Act Structure: 25% setup / 50% confrontation / 25% resolution\n    {% elif durationUnit <= 60 %}\n    MEDIUM FORMAT ({{ durationUnit }} minutes) - FIVE-ACT STRUCTURE:\n    - Structure Type: \"five-act\"\n    - Acts: 5 acts (Setup â Rising Action â Midpoint â Complications â Resolution)\n    - Story Beats: 10-18 (every {{ (durationUnit / 15)|round(1) }} minutes)\n    - Characters: 4-8 (protagonist + developed supporting characters)\n    - Locations: 4-8 locations\n    - Narrative Focus: Extended development with multiple turning points\n    - Subplots: 1-2 subplots that enhance main narrative\n    - Pacing: Proper character development time, building tension\n    - Act Structure: 20% setup / 25% rising action / 10% midpoint / 25% complications / 20% resolution\n    {% elif durationUnit <= 120 %}\n    FEATURE LENGTH ({{ durationUnit }} minutes) - SAVE THE CAT BEAT SHEET:\n    - Structure Type: \"save-the-cat\"\n    - Acts: 3 acts with 15 specific story beats\n    - Story Beats: 15 Save the Cat beats with precise timing\n    - Characters: 6-12 (complex character ensemble)\n    - Locations: 8-15 locations\n    - Narrative Focus: Blake Snyder's proven 15-beat Hollywood structure\n    - Subplots: 2-3 subplots weaving through main narrative\n    - Pacing: Deliberate character development, escalating complexity\n    - Beat Structure: Opening Image â Theme Stated â Setup â Catalyst â Debate â Break into Two â B Story â Fun and Games â Midpoint â Bad Guys Close In â All Is Lost â Dark Night of the Soul â Break into Three â Finale â Final Image\n    {% else %}\n    EXTENDED FORMAT ({{ durationUnit }} minutes) - EIGHT-SEQUENCE STRUCTURE:\n    - Structure Type: \"eight-sequence\"\n    - Sequences: 8 mini-movies, each with its own arc\n    - Story Beats: 24-32 beats across 8 sequences (3-4 beats per sequence)\n    - Characters: 8-20+ (epic ensemble with multiple protagonists)\n    - Locations: 12-25+ locations\n    - Narrative Focus: Eight mini-movies creating epic scope\n    - Subplots: 3-5 major subplots with their own complete arcs\n    - Pacing: Expansive world-building, multiple climaxes\n    - Sequence Structure: Each sequence ~15 minutes with setup/conflict/resolution\n    {% endif %}\n\n    ANALYSIS REQUIREMENTS:\n\n    1. GENERATE APPROPRIATE NARRATIVE STRUCTURE:\n    {% if durationUnit <= 2 %}\n    **SINGLE MOMENT STRUCTURE** ({{ durationUnit }} minutes):\n    You MUST create a \"single-moment\" structure with exactly 3 micro-acts and 2-4 story beats maximum:\n    - Act 1 (Setup): {{ (durationUnit * 60 * 0.2)|round }} seconds - Establish situation immediately\n    - Act 2 (Conflict/Revelation): {{ (durationUnit * 60 * 0.6)|round }} seconds - Central moment/realization\n    - Act 3 (Impact): {{ (durationUnit * 60 * 0.2)|round }} seconds - Immediate consequence\n\n    CRITICAL: Generate exactly 2-4 story beats total, focusing on one dramatic moment.\n    {% elif durationUnit <= 5 %}\n    **COMPRESSED THREE-ACT STRUCTURE** ({{ durationUnit }} minutes):\n    You MUST create a \"compressed-three-act\" structure with exactly 3 acts and 3-6 story beats maximum:\n    - Act 1 (Setup): {{ (durationUnit * 60 * 0.2)|round }} seconds - Quick character/situation setup\n    - Act 2 (Confrontation): {{ (durationUnit * 60 * 0.6)|round }} seconds - Rapid conflict development\n    - Act 3 (Resolution): {{ (durationUnit * 60 * 0.2)|round }} seconds - Swift resolution\n\n    CRITICAL: Generate exactly 3-6 story beats total, maintain single narrative thread.\n    {% elif durationUnit <= 30 %}\n    **TRADITIONAL THREE-ACT STRUCTURE** ({{ durationUnit }} minutes):\n    You MUST create a \"traditional-three-act\" structure with exactly 3 acts and 6-12 story beats maximum:\n    - Act 1 (Setup): {{ (durationUnit * 0.25)|round }} minutes - Character and world establishment\n    - Act 2 (Confrontation): {{ (durationUnit * 0.5)|round }} minutes - Conflict development and obstacles\n    - Act 3 (Resolution): {{ (durationUnit * 0.25)|round }} minutes - Climax and resolution\n\n    CRITICAL: Generate exactly 6-12 story beats total, allow 1 minor subplot maximum.\n    {% elif durationUnit <= 60 %}\n    **FIVE-ACT STRUCTURE** ({{ durationUnit }} minutes):\n    You MUST create a \"five-act\" structure with exactly 5 acts and 10-18 story beats maximum:\n    - Act 1 (Setup): {{ (durationUnit * 0.2)|round }} minutes - World and character introduction\n    - Act 2 (Rising Action): {{ (durationUnit * 0.25)|round }} minutes - Conflict development\n    - Act 3 (Midpoint): {{ (durationUnit * 0.1)|round }} minutes - Major turning point/revelation\n    - Act 4 (Complications): {{ (durationUnit * 0.25)|round }} minutes - Obstacles and setbacks\n    - Act 5 (Resolution): {{ (durationUnit * 0.2)|round }} minutes - Climax and conclusion\n\n    CRITICAL: Generate exactly 10-18 story beats total, allow 1-2 subplots maximum.\n    {% elif durationUnit <= 120 %}\n    **SAVE THE CAT BEAT SHEET STRUCTURE** ({{ durationUnit }} minutes):\n    You MUST create a \"save-the-cat\" structure with exactly 15 specific beats:\n    Generate exactly these 15 Save the Cat beats with precise timing:\n    1. Opening Image (0-1 min), 2. Theme Stated (5 min), 3. Setup (1-10 min), 4. Catalyst (12 min)\n    5. Debate (12-25 min), 6. Break into Two (25 min), 7. B Story (30 min), 8. Fun and Games (30-55 min)\n    9. Midpoint (55 min), 10. Bad Guys Close In (55-75 min), 11. All Is Lost (75 min)\n    12. Dark Night of the Soul (75-85 min), 13. Break into Three (85 min), 14. Finale (85-110 min), 15. Final Image (110 min)\n\n    CRITICAL: Generate exactly 15 Save the Cat beats, allow 2-3 subplots maximum.\n    {% else %}\n    **EIGHT-SEQUENCE STRUCTURE** ({{ durationUnit }} minutes):\n    You MUST create an \"eight-sequence\" structure with exactly 8 sequences and 24-32 story beats:\n    Each sequence ~{{ (durationUnit / 8)|round }} minutes:\n    - Sequence 1: Setup and Hook, Sequence 2: Inciting Incident, Sequence 3: First Obstacle\n    - Sequence 4: First Culmination, Sequence 5: Midpoint Shift, Sequence 6: Main Culmination\n    - Sequence 7: Third Act Twist, Sequence 8: Climax and Resolution\n\n    CRITICAL: Generate exactly 24-32 story beats across 8 sequences, allow 3-5 subplots maximum.\n    {% endif %}\n\n    2. ADAPTIVE STORY BEATS IDENTIFICATION:\n    - Extract the optimal number of story beats for {{ durationUnit }} minutes (see constraints above)\n    - Assign precise timing for each beat based on duration and structure type\n    - Identify characters present in each beat (within character limits)\n    - Classify emotional tone (tense, dramatic, comedic, romantic, action, suspenseful, emotional, mysterious)\n    - Ensure beats align with the chosen narrative structure\n    - For Save the Cat: Map beats to the 15 specific beat types\n    - For Eight-Sequence: Distribute beats across 8 sequences (3-4 beats per sequence)\n\n    3. DURATION-APPROPRIATE CHARACTER ARCS:\n    {% if durationUnit <= 2 %}\n    - Focus on single character moment/realization (no full transformation arc)\n    - Character change should be immediate and impactful\n    - Minimal character development time - show change through action\n    {% elif durationUnit <= 5 %}\n    - Simple character arc with clear before/after states\n    - Rapid character development through key moments\n    - Focus on one primary character transformation\n    {% elif durationUnit <= 30 %}\n    - Traditional character arcs with compressed development\n    - 2-3 main characters with meaningful growth\n    - Character development integrated with plot progression\n    {% elif durationUnit <= 60 %}\n    - Full character arcs with proper development time\n    - Multiple character transformations possible\n    - Character relationships drive story development\n    {% elif durationUnit <= 120 %}\n    - Complex character arcs with multiple growth phases\n    - Ensemble character development with interconnected arcs\n    - Deep psychological character exploration possible\n    {% else %}\n    - Epic character journeys with multiple transformation points\n    - Multiple protagonist arcs running parallel\n    - Generational or long-term character development\n    {% endif %}\n\n    4. ADAPTIVE SUBPLOT MANAGEMENT:\n    {% if durationUnit <= 5 %}\n    - NO SUBPLOTS: Maintain single narrative thread only\n    - All story elements must serve the main conflict directly\n    {% elif durationUnit <= 30 %}\n    - Maximum 1 minor subplot closely tied to main story\n    - Subplot must resolve within main narrative structure\n    - Subplot characters should be minimal (1-2 people)\n    {% elif durationUnit <= 60 %}\n    - 1-2 subplots that enhance main narrative themes\n    - Subplots can have their own minor character arcs\n    - Ensure subplot resolution doesn't compete with main climax\n    {% elif durationUnit <= 120 %}\n    - 2-3 subplots weaving through main narrative\n    - Subplots can have independent story beats and resolutions\n    - Complex character relationships between main plot and subplots\n    {% else %}\n    - 3-5 major subplots with complete story arcs\n    - Subplots can have their own three-act structures\n    - Multiple storylines can have separate climaxes and resolutions\n    {% endif %}\n\n    DURATION-ADAPTIVE QUALITY ASSESSMENT:\n    Rate the structural quality (1-100) based on format-appropriate criteria:\n    {% if durationUnit <= 5 %}\n    - Immediate story engagement and impact\n    - Efficient use of every moment\n    - Single conflict clarity and resolution\n    - Character moment authenticity\n    - Visual storytelling effectiveness\n    {% elif durationUnit <= 30 %}\n    - Clear three-act progression within time constraints\n    - Compressed but complete character development\n    - Effective story beat pacing\n    - Appropriate scope for duration\n    - Cinematic potential within format\n    {% elif durationUnit <= 120 %}\n    - Traditional three-act structure excellence\n    - Strong character arc development\n    - Compelling story beat progression\n    - Effective subplot integration\n    - Full cinematic storytelling potential\n    {% else %}\n    - Epic narrative structure coherence\n    - Multiple storyline management\n    - Complex character ensemble development\n    - Thematic depth and resonance\n    - Sustained audience engagement across extended runtime\n    {% endif %}\n\n    DURATION-SPECIFIC FORMATTING REQUIREMENTS:\n    - Optimize descriptions for {{ durationUnit }}-minute format requirements\n    - Focus on elements appropriate for the target duration\n    - Ensure story complexity matches available development time\n    - Character names consistent throughout (within character count limits)\n    - Story beats must flow logically within time constraints\n    - Pacing must feel natural for the specific duration category\n\n    Return your analysis in the exact JSON structure specified by the StoryStructureResponse class.\n\n    REQUIRED JSON STRUCTURE - GENERATE EXACTLY THIS FORMAT:\n    {\n      \"narrativeStructure\": {\n        {% if durationUnit <= 2 %}\n        \"structureType\": \"single-moment\",\n        \"adaptiveActs\": [\n          { \"actNumber\": 1, \"name\": \"Setup\", \"description\": \"Immediate situation establishment\", \"duration\": {{ (durationUnit * 60 * 0.2)|round }}, \"keyEvents\": [\"situation\", \"character\"], \"purpose\": \"Establish the dramatic moment context\" },\n          { \"actNumber\": 2, \"name\": \"Conflict/Revelation\", \"description\": \"Central moment/realization\", \"duration\": {{ (durationUnit * 60 * 0.6)|round }}, \"keyEvents\": [\"conflict\", \"realization\"], \"purpose\": \"The core dramatic moment\" },\n          { \"actNumber\": 3, \"name\": \"Impact\", \"description\": \"Immediate consequence\", \"duration\": {{ (durationUnit * 60 * 0.2)|round }}, \"keyEvents\": [\"consequence\"], \"purpose\": \"Show the impact of the moment\" }\n        ]\n        {% elif durationUnit <= 5 %}\n        \"structureType\": \"compressed-three-act\",\n        \"adaptiveActs\": [\n          { \"actNumber\": 1, \"name\": \"Setup\", \"description\": \"Quick character/situation setup\", \"duration\": {{ (durationUnit * 60 * 0.2)|round }}, \"keyEvents\": [\"character\", \"situation\"], \"purpose\": \"Rapid story establishment\" },\n          { \"actNumber\": 2, \"name\": \"Confrontation\", \"description\": \"Rapid conflict development\", \"duration\": {{ (durationUnit * 60 * 0.6)|round }}, \"keyEvents\": [\"conflict\", \"escalation\"], \"purpose\": \"Compressed conflict development\" },\n          { \"actNumber\": 3, \"name\": \"Resolution\", \"description\": \"Swift resolution\", \"duration\": {{ (durationUnit * 60 * 0.2)|round }}, \"keyEvents\": [\"climax\", \"resolution\"], \"purpose\": \"Quick resolution\" }\n        ]\n        {% elif durationUnit <= 10 %}\n        \"structureType\": \"traditional-three-act\",\n        \"adaptiveActs\": [\n          { \"actNumber\": 1, \"name\": \"Setup\", \"description\": \"Character and world establishment\", \"duration\": {{ (durationUnit * 60 * 0.25)|round }}, \"keyEvents\": [\"world\", \"character\", \"inciting\"], \"purpose\": \"Story foundation\" },\n          { \"actNumber\": 2, \"name\": \"Confrontation\", \"description\": \"Conflict development and obstacles\", \"duration\": {{ (durationUnit * 60 * 0.5)|round }}, \"keyEvents\": [\"obstacles\", \"midpoint\", \"crisis\"], \"purpose\": \"Conflict development\" },\n          { \"actNumber\": 3, \"name\": \"Resolution\", \"description\": \"Climax and resolution\", \"duration\": {{ (durationUnit * 60 * 0.25)|round }}, \"keyEvents\": [\"climax\", \"resolution\"], \"purpose\": \"Story conclusion\" }\n        ]\n        {% elif durationUnit <= 30 %}\n        \"structureType\": \"traditional-three-act\",\n        \"adaptiveActs\": [\n          { \"actNumber\": 1, \"name\": \"Setup\", \"description\": \"Character and world establishment\", \"duration\": {{ (durationUnit * 0.25)|round }}, \"keyEvents\": [\"world\", \"character\", \"inciting\"], \"purpose\": \"Story foundation\" },\n          { \"actNumber\": 2, \"name\": \"Confrontation\", \"description\": \"Conflict development and obstacles\", \"duration\": {{ (durationUnit * 0.5)|round }}, \"keyEvents\": [\"obstacles\", \"midpoint\", \"crisis\"], \"purpose\": \"Conflict development\" },\n          { \"actNumber\": 3, \"name\": \"Resolution\", \"description\": \"Climax and resolution\", \"duration\": {{ (durationUnit * 0.25)|round }}, \"keyEvents\": [\"climax\", \"resolution\"], \"purpose\": \"Story conclusion\" }\n        ]\n        {% elif durationUnit <= 60 %}\n        \"structureType\": \"five-act\",\n        \"adaptiveActs\": [\n          { \"actNumber\": 1, \"name\": \"Setup\", \"description\": \"World and character introduction\", \"duration\": {{ (durationUnit * 0.2)|round }}, \"keyEvents\": [\"world\", \"character\"], \"purpose\": \"Foundation\" },\n          { \"actNumber\": 2, \"name\": \"Rising Action\", \"description\": \"Conflict development\", \"duration\": {{ (durationUnit * 0.25)|round }}, \"keyEvents\": [\"conflict\", \"complications\"], \"purpose\": \"Build tension\" },\n          { \"actNumber\": 3, \"name\": \"Midpoint\", \"description\": \"Major turning point\", \"duration\": {{ (durationUnit * 0.1)|round }}, \"keyEvents\": [\"revelation\"], \"purpose\": \"Story pivot\" },\n          { \"actNumber\": 4, \"name\": \"Complications\", \"description\": \"Obstacles and setbacks\", \"duration\": {{ (durationUnit * 0.25)|round }}, \"keyEvents\": [\"obstacles\", \"crisis\"], \"purpose\": \"Escalate conflict\" },\n          { \"actNumber\": 5, \"name\": \"Resolution\", \"description\": \"Climax and conclusion\", \"duration\": {{ (durationUnit * 0.2)|round }}, \"keyEvents\": [\"climax\", \"resolution\"], \"purpose\": \"Conclusion\" }\n        ]\n        {% elif durationUnit <= 120 %}\n        \"structureType\": \"save-the-cat\",\n        \"adaptiveActs\": [\n          { \"actNumber\": 1, \"name\": \"Setup\", \"description\": \"Opening and setup\", \"duration\": {{ (durationUnit * 0.25)|round }}, \"keyEvents\": [\"opening\", \"theme\", \"catalyst\"], \"purpose\": \"Story foundation\" },\n          { \"actNumber\": 2, \"name\": \"Confrontation\", \"description\": \"Fun and games to crisis\", \"duration\": {{ (durationUnit * 0.5)|round }}, \"keyEvents\": [\"fun\", \"midpoint\", \"crisis\"], \"purpose\": \"Conflict development\" },\n          { \"actNumber\": 3, \"name\": \"Resolution\", \"description\": \"Dark night to finale\", \"duration\": {{ (durationUnit * 0.25)|round }}, \"keyEvents\": [\"dark\", \"finale\"], \"purpose\": \"Resolution\" }\n        ],\n        \"saveTheCatBeats\": [\n          { \"beatNumber\": 1, \"name\": \"Opening Image\", \"description\": \"Visual that sets tone\", \"pageNumber\": 1, \"timing\": 1, \"purpose\": \"Establish tone and world\" },\n          { \"beatNumber\": 2, \"name\": \"Theme Stated\", \"description\": \"Central theme introduced\", \"pageNumber\": 5, \"timing\": 5, \"purpose\": \"Present story's message\" }\n        ]\n        {% else %}\n        \"structureType\": \"eight-sequence\",\n        \"adaptiveActs\": [\n          { \"actNumber\": 1, \"name\": \"Setup\", \"description\": \"Epic world establishment\", \"duration\": {{ (durationUnit * 0.3)|round }}, \"keyEvents\": [\"world\", \"characters\", \"scope\"], \"purpose\": \"Epic foundation\" },\n          { \"actNumber\": 2, \"name\": \"Confrontation\", \"description\": \"Multiple storyline development\", \"duration\": {{ (durationUnit * 0.45)|round }}, \"keyEvents\": [\"conflicts\", \"convergence\"], \"purpose\": \"Epic conflict\" },\n          { \"actNumber\": 3, \"name\": \"Resolution\", \"description\": \"Epic conclusion\", \"duration\": {{ (durationUnit * 0.25)|round }}, \"keyEvents\": [\"climaxes\", \"resolution\"], \"purpose\": \"Epic resolution\" }\n        ],\n        \"sequences\": [\n          { \"sequenceNumber\": 1, \"name\": \"Setup and Hook\", \"description\": \"Epic opening\", \"duration\": {{ (durationUnit / 8)|round }}, \"miniMovieArc\": \"Introduction to epic world\", \"keyBeats\": [\"hook\", \"world\", \"characters\"] }\n        ]\n        {% endif %}\n      },\n      \"storyBeats\": [\n        { \"beat\": \"Beat Name\", \"timing\": 5, \"description\": \"...\", \"characters\": [\"Character1\"], \"emotionalTone\": \"dramatic\" }\n      ],\n      \"characterArcs\": [\n        { \"character\": \"Character Name\", \"startState\": \"...\", \"endState\": \"...\", \"transformation\": \"...\", \"keyMoments\": [\"moment1\", \"moment2\"] }\n      ],\n      \"subplots\": [\n        { \"name\": \"Subplot Name\", \"description\": \"...\", \"resolution\": \"...\", \"charactersInvolved\": [\"Character1\"] }\n      ],\n      \"qualityScore\": 85,\n      \"generationNotes\": \"Analysis notes including structure type rationale and compliance with {{ durationUnit }}-minute format constraints...\"\n    }\n\n    CRITICAL CONSTRAINTS - YOU MUST FOLLOW THESE EXACTLY:\n    {% if durationUnit <= 2 %}\n    - Generate EXACTLY 2-4 story beats (not 10+)\n    - Use \"single-moment\" structure type\n    - NO subplots allowed (empty array)\n    - Focus on ONE dramatic moment only\n    - Act durations MUST be: {{ (durationUnit * 60 * 0.2)|round }}, {{ (durationUnit * 60 * 0.6)|round }}, {{ (durationUnit * 60 * 0.2)|round }} seconds\n    {% elif durationUnit <= 5 %}\n    - Generate EXACTLY 3-6 story beats (not 10+)\n    - Use \"compressed-three-act\" structure type\n    - NO subplots allowed (empty array)\n    - Single narrative thread only\n    - Act durations MUST be: {{ (durationUnit * 60 * 0.2)|round }}, {{ (durationUnit * 60 * 0.6)|round }}, {{ (durationUnit * 60 * 0.2)|round }} seconds\n    {% elif durationUnit <= 30 %}\n    - Generate EXACTLY 6-12 story beats\n    - Use \"traditional-three-act\" structure type\n    - Maximum 1 minor subplot\n    {% elif durationUnit <= 60 %}\n    - Generate EXACTLY 10-18 story beats\n    - Use \"five-act\" structure type\n    - Maximum 1-2 subplots\n    {% elif durationUnit <= 120 %}\n    - Generate EXACTLY 15 story beats (Save the Cat beats)\n    - Use \"save-the-cat\" structure type\n    - Maximum 2-3 subplots\n    {% else %}\n    - Generate EXACTLY 24-32 story beats\n    - Use \"eight-sequence\" structure type\n    - Maximum 3-5 subplots\n    {% endif %}\n\n    REMEMBER: This is a {{ durationUnit }}-minute film. Every element must fit this duration constraint.\n  \"#\n}\n\n// Function to enhance existing story structure\nfunction EnhanceStoryStructure(\n  currentStructure: string,\n  storyContent: string,\n  focusAreas: string[],\n  targetQualityScore: int\n) -> StoryStructureResponse {\n  client OpenRouterAdvanced\n  prompt #\"\n    You are a story structure enhancement specialist. Your task is to improve an existing story structure analysis by focusing on specific areas while maintaining narrative coherence.\n\n    CURRENT STORY STRUCTURE:\n    {{ currentStructure }}\n\n    ORIGINAL STORY CONTENT:\n    {{ storyContent }}\n\n    ENHANCEMENT FOCUS AREAS:\n    {{ focusAreas|join(\", \") }}\n\n    TARGET QUALITY SCORE: {{ targetQualityScore }}/100\n\n    ENHANCEMENT GUIDELINES:\n    1. Preserve the core narrative structure while improving weak areas\n    2. Strengthen character arcs and motivations\n    3. Improve pacing and story beat progression\n    4. Enhance subplot integration with main plot\n    5. Ensure cinematic viability and visual storytelling potential\n\n    Focus particularly on the specified enhancement areas while maintaining overall story coherence. Return an improved structure that addresses the identified weaknesses.\n  \"#\n}\n\n// Function to validate story structure for screenplay readiness\nfunction ValidateStructureForScreenplay(\n  storyStructure: string,\n  targetDuration: int,\n  movieFormat: string\n) -> StructureValidationResponse {\n  client OpenRouterAdvanced\n  prompt #\"\n    You are a screenplay structure validator. Analyze the provided story structure and assess its readiness for screenplay conversion.\n\n    STORY STRUCTURE TO VALIDATE:\n    {{ storyStructure }}\n\n    TARGET SPECIFICATIONS:\n    - Duration: {{ targetDuration }} minutes\n    - Format: {{ movieFormat }}\n\n    VALIDATION CRITERIA:\n    1. Act timing and pacing appropriateness\n    2. Character arc completeness and motivation clarity\n    3. Story beat logical progression and tension building\n    4. Subplot integration and resolution\n    5. Cinematic translation potential\n    6. Format-specific requirements (feature vs short film vs series)\n\n    Provide detailed feedback on strengths, weaknesses, and specific recommendations for improvement before screenplay generation.\n  \"#\n}\n\nclass StructureValidationResponse {\n  isReady bool\n  overallScore int\n  strengths string[]\n  weaknesses string[]\n  recommendations string[]\n  criticalIssues string[]\n}\n",
}
export const getBamlFiles = () => {
    return fileMap;
}